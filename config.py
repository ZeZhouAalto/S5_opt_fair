import json

class globalData():

	def __init__(self):
		self.requests = dict()
		self.reqDeadline = dict()
		self.garageIndex = dict()
		self.garageTupleList = list()
		self.distance_look_up = dict()

		self.getGarageIndex()
		
		self.getReqs()
		self.getGarageTuple()
		self.getDistance()


	# get garage index
	def getGarageIndex(self):
		garages = ['GARAGE 516', 'GARAGE 517', 'GARAGE 151', 'GARAGE 523', 'GARAGE 568', 'GARAGE 217', 'GARAGE 546', 'GARAGE 440', 'GARAGE 119', 'GARAGE 66', 'GARAGE 28', 'GARAGE 385', 'GARAGE 154', 'GARAGE 518', 'GARAGE 529', 'GARAGE 54', 'GARAGE 15', 'GARAGE 490', 'GARAGE 170', 'GARAGE 130', 'GARAGE 145', 'GARAGE 531', 'GARAGE 431', 'GARAGE 615', 'GARAGE 65', 'GARAGE 564', 'GARAGE 159', 'GARAGE 215', 'GARAGE 289', 'GARAGE 403', 'GARAGE 538', 'GARAGE 24', 'GARAGE 133', 'GARAGE 553', 'GARAGE 277', 'GARAGE 124', 'GARAGE 108', 'GARAGE 418', 'GARAGE 484', 'GARAGE 368', 'GARAGE 204', 'GARAGE 148', 'GARAGE 394', 'GARAGE 310', 'GARAGE 216', 'GARAGE 367', 'GARAGE 135', 'GARAGE 114', 'GARAGE 4', 'GARAGE 191', 'GARAGE 274', 'GARAGE 37', 'GARAGE 429', 'GARAGE 112', 'GARAGE 382', 'GARAGE 577', 'GARAGE 601', 'GARAGE 45', 'GARAGE 284', 'GARAGE 402', 'GARAGE 64', 'GARAGE 409', 'GARAGE 180', 'GARAGE 27', 'GARAGE 407', 'GARAGE 160', 'GARAGE 537', 'GARAGE 52', 'GARAGE 563', 'GARAGE 416', 'GARAGE 565', 'GARAGE 421', 'GARAGE 322', 'GARAGE 554', 'GARAGE 597', 'GARAGE 526', 'GARAGE 198', 'GARAGE 22', 'GARAGE 425', 'GARAGE 40', 'GARAGE 29', 'GARAGE 245', 'GARAGE 486', 'GARAGE 308', 'GARAGE 282', 'GARAGE 48', 'GARAGE 540', 'GARAGE 337', 'GARAGE 547', 'GARAGE 539', 'GARAGE 392', 'GARAGE 291', 'GARAGE 465', 'GARAGE 432', 'GARAGE 187', 'GARAGE 150', 'GARAGE 34', 'GARAGE 72', 'GARAGE 536', 'GARAGE 123', 'GARAGE 544', 'GARAGE 556', 'GARAGE 347', 'GARAGE 457', 'GARAGE 111', 'GARAGE 395', 'GARAGE 369', 'GARAGE 91', 'GARAGE 84', 'GARAGE 137', 'GARAGE 3', 'GARAGE 442', 'GARAGE 552', 'GARAGE 598', 'GARAGE 175', 'GARAGE 422', 'GARAGE 370', 'GARAGE 299', 'GARAGE 21', 'GARAGE 562', 'GARAGE 341', 'GARAGE 157', 'GARAGE 181', 'GARAGE 413', 'GARAGE 120', 'GARAGE 448', 'GARAGE 76', 'GARAGE 493', 'GARAGE 603', 'GARAGE 511', 'GARAGE 524', 'GARAGE 50', 'GARAGE 235', 'GARAGE 162', 'GARAGE 339', 'GARAGE 445', 'GARAGE 278', 'GARAGE 109', 'GARAGE 36', 'GARAGE 426', 'GARAGE 125', 'GARAGE 397', 'GARAGE 58', 'GARAGE 311', 'GARAGE 411', 'GARAGE 471', 'GARAGE 177', 'GARAGE 155', 'GARAGE 458', 'GARAGE 31', 'GARAGE 579', 'GARAGE 102', 'GARAGE 296', 'GARAGE 317', 'GARAGE 462', 'GARAGE 433', 'GARAGE 244', 'GARAGE 482', 'GARAGE 476', 'GARAGE 233', 'GARAGE 330', 'GARAGE 513', 'GARAGE 158', 'GARAGE 307', 'GARAGE 192', 'GARAGE 494', 'GARAGE 377', 'GARAGE 75', 'GARAGE 279', 'GARAGE 497', 'GARAGE 545', 'GARAGE 190', 'GARAGE 242', 'GARAGE 86', 'GARAGE 364', 'GARAGE 503', 'GARAGE 127', 'GARAGE 90', 'GARAGE 464', 'GARAGE 460', 'GARAGE 110', 'GARAGE 92', 'GARAGE 14', 'GARAGE 2', 'GARAGE 588', 'GARAGE 165', 'GARAGE 228', 'GARAGE 412', 'GARAGE 472', 'GARAGE 570', 'GARAGE 316', 'GARAGE 399', 'GARAGE 351', 'GARAGE 83', 'GARAGE 261', 'GARAGE 223', 'GARAGE 80', 'GARAGE 247', 'GARAGE 106', 'GARAGE 141', 'GARAGE 96', 'GARAGE 360', 'GARAGE 525', 'GARAGE 98', 'GARAGE 567', 'GARAGE 356', 'GARAGE 572', 'GARAGE 334', 'GARAGE 355', 'GARAGE 46', 'GARAGE 443', 'GARAGE 97', 'GARAGE 81', 'GARAGE 501', 'GARAGE 275', 'GARAGE 176', 'GARAGE 260', 'GARAGE 122', 'GARAGE 209', 'GARAGE 586', 'GARAGE 79', 'GARAGE 306', 'GARAGE 480', 'GARAGE 384', 'GARAGE 391', 'GARAGE 436', 'GARAGE 272', 'GARAGE 166', 'GARAGE 146', 'GARAGE 304', 'GARAGE 548', 'GARAGE 25', 'GARAGE 269', 'GARAGE 262', 'GARAGE 463', 'GARAGE 152', 'GARAGE 283', 'GARAGE 372', 'GARAGE 475', 'GARAGE 366', 'GARAGE 254', 'GARAGE 473', 'GARAGE 101', 'GARAGE 179', 'GARAGE 302', 'GARAGE 469', 'GARAGE 573', 'GARAGE 444', 'GARAGE 182', 'GARAGE 239', 'GARAGE 264', 'GARAGE 257', 'GARAGE 259', 'GARAGE 599', 'GARAGE 414', 'GARAGE 361', 'GARAGE 338', 'GARAGE 376', 'GARAGE 89', 'GARAGE 82', 'GARAGE 352', 'GARAGE 63', 'GARAGE 335', 'GARAGE 276', 'GARAGE 268', 'GARAGE 188', 'GARAGE 612', 'GARAGE 467', 'GARAGE 346', 'GARAGE 453', 'GARAGE 423', 'GARAGE 51', 'GARAGE 406', 'GARAGE 288', 'GARAGE 139', 'GARAGE 195', 'GARAGE 237', 'GARAGE 555', 'GARAGE 200', 'GARAGE 305', 'GARAGE 398', 'GARAGE 374', 'GARAGE 1', 'GARAGE 468', 'GARAGE 530', 'GARAGE 250', 'GARAGE 218', 'GARAGE 510', 'GARAGE 241', 'GARAGE 118', 'GARAGE 303', 'GARAGE 266', 'GARAGE 100', 'GARAGE 401', 'GARAGE 246', 'GARAGE 285', 'GARAGE 142', 'GARAGE 332', 'GARAGE 117', 'GARAGE 49', 'GARAGE 270', 'GARAGE 232', 'GARAGE 587', 'GARAGE 549', 'GARAGE 437', 'GARAGE 69', 'GARAGE 325', 'GARAGE 134', 'GARAGE 527', 'GARAGE 26', 'GARAGE 35', 'GARAGE 478', 'GARAGE 474', 'GARAGE 604', 'GARAGE 73', 'GARAGE 485', 'GARAGE 329', 'GARAGE 39', 'GARAGE 607', 'GARAGE 68', 'GARAGE 578', 'GARAGE 318', 'GARAGE 492', 'GARAGE 522', 'GARAGE 189', 'GARAGE 202', 'GARAGE 461', 'GARAGE 608', 'GARAGE 327', 'GARAGE 606', 'GARAGE 584', 'GARAGE 580', 'GARAGE 326', 'GARAGE 199', 'GARAGE 435', 'GARAGE 499', 'GARAGE 309', 'GARAGE 600', 'GARAGE 400', 'GARAGE 500', 'GARAGE 427', 'GARAGE 345', 'GARAGE 434', 'GARAGE 331', 'GARAGE 609', 'GARAGE 550', 'GARAGE 455', 'GARAGE 569', 'GARAGE 56', 'GARAGE 115', 'GARAGE 602', 'GARAGE 78', 'GARAGE 428', 'GARAGE 219', 'GARAGE 446', 'GARAGE 591', 'GARAGE 430', 'GARAGE 226', 'GARAGE 143', 'GARAGE 373', 'GARAGE 515', 'GARAGE 521', 'GARAGE 596', 'GARAGE 38', 'GARAGE 528', 'GARAGE 44', 'GARAGE 8', 'GARAGE 313', 'GARAGE 298', 'GARAGE 30', 'GARAGE 574', 'GARAGE 466', 'GARAGE 222', 'GARAGE 388', 'GARAGE 328', 'GARAGE 229', 'GARAGE 208', 'GARAGE 343', 'GARAGE 243', 'GARAGE 438', 'GARAGE 354', 'GARAGE 13', 'GARAGE 498', 'GARAGE 171', 'GARAGE 378', 'GARAGE 533', 'GARAGE 281', 'GARAGE 104', 'GARAGE 212', 'GARAGE 320', 'GARAGE 183', 'GARAGE 470', 'GARAGE 420', 'GARAGE 43', 'GARAGE 353', 'GARAGE 205', 'GARAGE 348', 'GARAGE 344', 'GARAGE 451', 'GARAGE 379', 'GARAGE 454', 'GARAGE 128', 'GARAGE 57', 'GARAGE 105', 'GARAGE 575', 'GARAGE 380', 'GARAGE 559', 'GARAGE 419', 'GARAGE 258', 'GARAGE 479', 'GARAGE 410', 'GARAGE 333', 'GARAGE 136', 'GARAGE 103', 'GARAGE 59', 'GARAGE 210', 'GARAGE 535', 'GARAGE 358', 'GARAGE 163', 'GARAGE 507', 'GARAGE 415', 'GARAGE 456', 'GARAGE 543', 'GARAGE 93', 'GARAGE 520', 'GARAGE 405', 'GARAGE 595', 'GARAGE 74', 'GARAGE 505', 'GARAGE 532', 'GARAGE 168', 'GARAGE 10', 'GARAGE 447', 'GARAGE 576', 'GARAGE 61', 'GARAGE 301', 'GARAGE 67', 'GARAGE 362', 'GARAGE 295', 'GARAGE 77', 'GARAGE 236', 'GARAGE 144', 'GARAGE 16', 'GARAGE 560', 'GARAGE 393', 'GARAGE 164', 'GARAGE 213', 'GARAGE 491', 'GARAGE 129', 'GARAGE 512', 'GARAGE 113', 'GARAGE 156', 'GARAGE 396', 'GARAGE 506', 'GARAGE 23', 'GARAGE 121', 'GARAGE 290', 'GARAGE 294', 'GARAGE 265', 'GARAGE 178', 'GARAGE 60', 'GARAGE 88', 'GARAGE 488', 'GARAGE 417', 'GARAGE 551', 'GARAGE 349', 'GARAGE 169', 'GARAGE 365', 'GARAGE 558', 'GARAGE 196', 'GARAGE 201', 'GARAGE 449', 'GARAGE 613', 'GARAGE 424', 'GARAGE 561', 'GARAGE 439', 'GARAGE 207', 'GARAGE 340', 'GARAGE 252', 'GARAGE 315', 'GARAGE 557', 'GARAGE 459', 'GARAGE 300', 'GARAGE 324', 'GARAGE 240', 'GARAGE 271', 'GARAGE 42', 'GARAGE 203', 'GARAGE 495', 'GARAGE 336', 'GARAGE 221', 'GARAGE 312', 'GARAGE 357', 'GARAGE 263', 'GARAGE 55', 'GARAGE 585', 'GARAGE 293', 'GARAGE 267', 'GARAGE 581', 'GARAGE 197', 'GARAGE 19', 'GARAGE 594', 'GARAGE 234', 'GARAGE 383', 'GARAGE 172', 'GARAGE 481', 'GARAGE 592', 'GARAGE 404', 'GARAGE 230', 'GARAGE 314', 'GARAGE 614', 'GARAGE 487', 'GARAGE 161', 'GARAGE 319', 'GARAGE 321', 'GARAGE 359', 'GARAGE 280', 'GARAGE 18', 'GARAGE 611', 'GARAGE 11', 'GARAGE 220', 'GARAGE 256', 'GARAGE 389', 'GARAGE 206', 'GARAGE 20', 'GARAGE 450', 'GARAGE 381', 'GARAGE 342', 'GARAGE 387', 'GARAGE 363', 'GARAGE 138', 'GARAGE 6', 'GARAGE 583', 'GARAGE 185', 'GARAGE 140', 'GARAGE 225', 'GARAGE 610', 'GARAGE 107', 'GARAGE 251', 'GARAGE 616', 'GARAGE 147', 'GARAGE 116', 'GARAGE 323', 'GARAGE 508', 'GARAGE 566', 'GARAGE 519', 'GARAGE 589', 'GARAGE 32', 'GARAGE 390', 'GARAGE 590', 'GARAGE 7', 'GARAGE 287', 'GARAGE 582', 'GARAGE 53', 'GARAGE 477', 'GARAGE 95', 'GARAGE 441', 'GARAGE 386', 'GARAGE 131', 'GARAGE 193', 'GARAGE 184', 'GARAGE 593', 'GARAGE 483', 'GARAGE 12', 'GARAGE 238', 'GARAGE 70', 'GARAGE 255', 'GARAGE 47', 'GARAGE 541', 'GARAGE 214', 'GARAGE 286', 'GARAGE 87', 'GARAGE 9', 'GARAGE 211', 'GARAGE 605', 'GARAGE 149', 'GARAGE 514', 'GARAGE 153', 'GARAGE 542', 'GARAGE 273', 'GARAGE 167', 'GARAGE 186', 'GARAGE 62', 'GARAGE 292', 'GARAGE 253', 'GARAGE 126', 'GARAGE 496', 'GARAGE 94', 'GARAGE 534', 'GARAGE 99', 'GARAGE 502', 'GARAGE 375', 'GARAGE 224', 'GARAGE 408', 'GARAGE 17', 'GARAGE 350', 'GARAGE 571', 'GARAGE 71', 'GARAGE 194', 'GARAGE 297', 'GARAGE 85', 'GARAGE 174', 'GARAGE 173', 'GARAGE 231', 'GARAGE 33', 'GARAGE 41', 'GARAGE 489', 'GARAGE 5', 'GARAGE 504', 'GARAGE 509']
		garages.sort(key= lambda x: float(x.strip('GARAGE ')))
		for index, garage_name in enumerate(garages):
			self.garageIndex.update( {garage_name:index} )

	# read requests
	def getReqs(self):
		timeOffset = 0
		with open('Input_S3/time_look_up.json', 'r') as fp:
			lookUpTable = json.load(fp)
		with open('Input_S3/req_8_10_min_wait.json', 'r') as data_file:
		# with open('Input_S3/less_reqs_with_waiting.json', 'r') as data_file:
			reqData = json.load(data_file)
			for r in reqData:
				r["time"] += timeOffset     # change the request time manually

				deadline = r["time"] + r["reservation_time"] + r["detour_time"] + lookUpTable[ r["origin"]["object"] ][ self.garageIndex[r["destination"]["object"]] ]
				not_interested = ["destination_time","name","person_type","req_purpose","people","extra_value"]
				dict_cleaned = {key: value for key, value in r.items() if key not in not_interested}
				self.requests.update({r["id"]: dict_cleaned})
				self.reqDeadline.update({r["id"]: deadline})

	def getGarageTuple(self):
		with open('Input_S3/garageTupleList.json', 'r') as f:
			self.garageTupleList = json.load(f)

	def getDistance(self):
		with open('Input_S3/distance_look_up.json', 'r') as fp:
			self.distance_look_up = json.load(fp)

data = globalData()